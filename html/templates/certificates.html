<h2>Key Certificates And Trust</h2>

<p>
Cryptographic keys are just numbers - by themselves they don't convey any meaning of trust. Trust in cryptographic keys is gained through public key certificates. Although we do not intend to fully go into detail about digital-signatures, it is useful to know how documents are signed in the digital world.

Let's say that Bob wants to send Alice an encrypted message using his public key. Alice wants to be sure that the public key she has for Bob is authentic and has not been tampered with by an attacker. To achieve this, Bob can obtain a certificate from a trusted third-party called a Certificate Authority (CA). The CA is responsible for verifying Bob's identity and signing the certificate with its own private key. The signed certificate includes Bob's public key and other information, such as his name and email address.

When Alice receives Bob's encrypted message, she can use Bob's public key to decrypt it. However, before doing so, she should verify the signature on Bob's certificate. To do this, she can use the CA's public key to verify the signature on the certificate. If the signature is valid, she can be confident that the public key belongs to Bob and has not been tampered with.

As we've seen, keys generated by the TPM are protected by their parent keys - if you trust the parent key is not compromised, then you can trust all the keys rooted under it. What about the primary key? How do you know it's coming from a genuine TPM device, that's conformant to the spec? The answer is the primary key certificate, issued by the TPM manufacturer.

</p>

<h3>EK Certificate</h3>

<p>
  In the case of TPMs, the primary endorsement key (EK) is a key that can be trusted if it is verified through its associated certificate.
  
  The EK certificate is issued by the TPM vendor during manufacturing and is signed by a key that's only available to the vendor. The vendor's root key certificate is usually distributed on the vendor's website and can be downloaded over SSL. At the end of manufacturing, a signed EK certificate is stored in the TPM's non-volatile data storage (NVDATA).
  
</p>

<p>
  EK certificate provisioning process looks like this:

  <img src="images/ek_cert_1.svg" class="img-responsive center-block" style="max-width:70%"
    alt="EK Cert">

  <br>
</p>

<p>
  The TPM user can read the EK certificate from NVDATA at any time and verify its signature chain. If the certificate is valid and the user trusts the vendor, then the primary endorsement key can be trusted. If the EK is trusted, then all the keys protected by it can be trusted.

  <img src="images/ek_cert_2.svg" class="img-responsive center-block" style="max-width:70%"
    alt="EK Cert">

  <br>
  <div class="alert alert-info" role="alert">If the certificate is valid, and you trust the vendor - then the primary endorsement
    key can be trusted.
  </div>
</p>

<h3>EK Template</h3>

<p>
  Overall, the use of certificates and endorsement keys is crucial for establishing trust in the cryptographic keys generated and protected by the TPM. By verifying the EK certificate, users can be confident that the primary endorsement key comes from a genuine TPM device that is conformant to the spec, and that all keys rooted under it can be trusted.
</p>