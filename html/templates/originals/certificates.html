<h2>Key Certificates And Trust</h2>

<p>
  Cryptographic keys are just numbers - by themselves they don't convey any meaning
  of trust. Trust in cryptographic keys is gained through <a href="https://en.wikipedia.org/wiki/Public_key_certificate">public key certificates</a>.

  <br> As we've seen, keys generated by the TPM are protected by their parent keys
  - if you trust the parent key is not compromised, then you can trust all the
  keys rooted under it. What about the <b>primary key</b>? How do you know it's
  coming from a genuine TPM device, that's conformant to the spec? The answer is
  the primary key certificate, issued by the TPM manufacturer.
</p>

<h3>EK Certificate</h3>

<p>
  The EK certificate certifies the primary endorsement key. It is issued by the TPM
  vendor during manufacturing, and signed by a key that's only available to the
  vendor. The vendor's root key certificate is usually distributed on the vendor's
  website, where it can be downloaded over SSL.
</p>

<p>
  EK certificate provisioning process looks like this:

  <img src="images/ek_cert_1.svg" class="img-responsive center-block" style="max-width:70%"
    alt="EK Cert">

  <br> At the end, a signed EK certificate is stored in the TPM's NVDATA.
</p>

<p>
  The TPM user can, at any time, read the EK certificate from NVDATA, and verify
  its signature chain:

  <img src="images/ek_cert_2.svg" class="img-responsive center-block" style="max-width:70%"
    alt="EK Cert">

  <br>
  <div class="alert alert-info" role="alert">If the certificate is valid, and you trust the vendor - then the primary endorsement
    key can be trusted.
    <br>If the EK is trusted, then all the keys protected by it can be trusted.</div>
</p>

<h3>EK Template</h3>

<p>
  EK is derived from the eseed and a TPM2B_PUBLIC template. TCG defines two <b>default
  templates</b> for EKs, one for RSA keys and one for ECC keys. If a vendor certifies
  a key other than the default RSA-EK or ECC-EK, they have to store the template
  used for creation and its <i>unique</i> value in NVDATA, next to the EK certificate.

  <br> There are reserved NV indices for RSA-EK certificate and ECC-EK certificate.
  There are reserved NV indices for the EK templates.

</p>